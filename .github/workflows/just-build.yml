name: 'just build'

# è§¦å‘å·¥ä½œæµçš„äº‹ä»¶
on:
  # å…è®¸åœ¨ GitHub Actions UI ä¸­æ‰‹åŠ¨è§¦å‘
  workflow_dispatch:

jobs:
  building:
    # ä½¿ç”¨æœ€æ–°çš„ Ubuntu è¿è¡Œç¯å¢ƒ
    runs-on: 'ubuntu-latest'

    steps:
      - name: 'â¬‡ï¸ Checkout Repository'
        # æ£€å‡ºä»£ç åˆ° Runner
        uses: 'actions/checkout@v4'

      - name: 'âš™ï¸ Setup Node.js 20'
        # æ ¹æ® package.json ä¸­çš„ "engines": {"node": ">=20"} è®¾ç½® Node.js ç¯å¢ƒ
        uses: 'actions/setup-node@v4'
        with:
          node-version: '20'
          cache: 'npm' # å¯ç”¨ npm ç¼“å­˜

      - name: 'ğŸ“¦ Install Dependencies'
        # ä½¿ç”¨ npm ci è¿›è¡Œå¹²å‡€å®‰è£…
        run: 'npm ci'

      - name: 'ğŸ”¬ Run build Script'
        # æ‰§è¡Œé¢„æ£€æŸ¥è„šæœ¬ï¼Œè¯¥è„šæœ¬åº”åŒ…å«æ„å»ºå’Œæµ‹è¯•
        run: 'npm run build'

      - name: 'â¬†ï¸ Upload Build Artifacts (packages/*/dist)'
        # ä¸Šä¼ æ‰€æœ‰å­åŒ…çš„æ„å»ºç»“æœ
        uses: 'actions/upload-artifact@v4'
        with:
          name: 'preflight-build-artifacts-${{ github.sha }}'
          # åŒ¹é…æ‰€æœ‰ packages/ ç›®å½•ä¸‹çš„å­åŒ…çš„ dist/ ç›®å½•
          path: |
            packages/*/dist/
          retention-days: 7 # äº§ç‰©ä¿ç•™ 7 å¤©
